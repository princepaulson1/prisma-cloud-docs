<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title></title>
</head>
<body>
    <header>
        <h1></h1>
    </header>
    <main>
        <div id="toc" class="toc">
<div id="toctitle">Table of Contents</div>
<ul class="sectlevel1">
<li><a href="#the-terminated-pod-gc-threshold-argument-for-controller-managers-is-not-set-appropriately">1. The --terminated-pod-gc-threshold argument for controller managers is not set appropriately</a>
<ul class="sectlevel2">
<li><a href="#policy-details">1.1. Policy Details</a></li>
<li><a href="#description">1.2. Description</a></li>
<li><a href="#fix-buildtime">1.3. Fix - Buildtime</a></li>
</ul>
</li>
</ul>
</div>
<div class="sect1">
<h2 id="the-terminated-pod-gc-threshold-argument-for-controller-managers-is-not-set-appropriately">1. The --terminated-pod-gc-threshold argument for controller managers is not set appropriately</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="policy-details">1.1. Policy Details</h3>
<table class="tableblock frame-all grid-all" style="width: 45%;">
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Prisma Cloud Policy ID</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">5572ef68-3823-48f9-b2d0-e17d6d002366</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Checkov ID</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://github.com/bridgecrewio/checkov/tree/master/checkov/kubernetes/checks/resource/k8s/KubeControllerManagerTerminatedPods.py">CKV_K8S_106</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Severity</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">MEDIUM</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Subtype</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Build</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Frameworks</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Kubernetes,Helm,Kustomize</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect2">
<h3 id="description">1.2. Description</h3>
<div class="paragraph">
<p>Activate garbage collector on pod termination, as appropriate..
Garbage collection is important to ensure sufficient resource availability and avoiding degraded performance and availability.
In the worst case, the system might crash or just be unusable for a long period of time.
The current setting for garbage collection is 12,500 terminated pods which might be too high for your system to sustain.
Based on your system resources and tests, choose an appropriate threshold value to activate garbage collection.</p>
</div>
</div>
<div class="sect2">
<h3 id="fix-buildtime">1.3. Fix - Buildtime</h3>
<div class="paragraph">
<p><strong>Kubernetes</strong></p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>Kind:</strong> Pod</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-yaml" data-lang="yaml">{
 "  apiVersion: v1
  kind: Pod
  metadata:
    creationTimestamp: null
    labels:
      component: kube-controller-manager
      tier: control-plane
    name: kube-controller-manager
    namespace: kube-system
  spec:
    containers:
    - command:
      - kube-controller-manager
+     -  --terminated-pod-gc-threshold=555
      image: gcr.io/google_containers/kube-controller-manager-amd64:v1.6.0
      livenessProbe:
        failureThreshold: 8
        httpGet:
          host: 127.0.0.1
          path: /healthz
          port: 6443
          scheme: HTTPS
        initialDelaySeconds: 15
        timeoutSeconds: 15
      name: kube-controller-manager-should-pass
      resources:
        requests:
          cpu: 250m
      volumeMounts:
      - mountPath: /etc/kubernetes/
        name: k8s
        readOnly: true
      - mountPath: /etc/ssl/certs
        name: certs
      - mountPath: /etc/pki
        name: pki
    hostNetwork: true
    volumes:
    - hostPath:
        path: /etc/kubernetes
      name: k8s
    - hostPath:
        path: /etc/ssl/certs
      name: certs
    - hostPath:
        path: /etc/pki
      name: pki ",
}</code></pre>
</div>
</div>
</div>
</div>
</div>
    </main>
    <footer>
        <p>&copy; 2024</p>
    </footer>
</body>
</html>
